# sv-env-code-vulnerability

Security Verifiers RL environment for **Vulnerability Assessment in Code Snippets** - a ToolEnv/MultiTurnEnv implementation where models inspect source code for security vulnerabilities and suggest fixes.

## Overview

This environment implements PRD Environment #5: An environment where the model inspects a piece of source code for security vulnerabilities and suggests a fix. This can be approached as either a step-by-step interactive task or a single-turn task. We implement it as a multi-turn scenario enhanced with tools where the model can call static analysis functions and propose corrected code snippets.

## Task Description

- **Input**: Source code snippets with known vulnerabilities
- **Output**: Vulnerability identification and corrected code
- **Environment Type**: ToolEnv/MultiTurnEnv (model can call analysis tools)
- **Reward**: Based on successful vulnerability detection and fix quality

## Example

```
Prompt: [C function with buffer overflow vulnerability]
Turn 1: Model calls scan_code tool to identify issues
        Tool returns: "Buffer overflow detected at line 5: use of gets()"
Turn 2: Model outputs fixed code with safe alternatives
Expected: Corrected function using fgets() instead of gets()
```

## Implementation

Uses the Verifiers framework with:
- Dataset: Big-Vul dataset or CodeXGLUE defect detection datasets
- Tools: Static analysis functions (Bandit for Python, custom analyzers for C/C++)
- Rubric: Verification that original vulnerabilities are fixed without introducing new ones
- Reward function: +1 for fixing vulnerabilities, penalties for new bugs or broken functionality

## Why This Task is Useful

- **Software Security**: Automated vulnerability detection and repair is crucial for secure coding
- **Supply Chain Security**: Many vulnerabilities in open source could be patched by AI
- **Developer Assistance**: Can serve as intelligent code review tool
- **Security Training**: Models learn to follow secure coding standards and avoid common pitfalls
- **Scalability**: Can analyze code at scale, catching issues human reviewers might miss

## Detection and Repair Capabilities

The model learns to:
- Identify common vulnerability patterns (buffer overflows, SQL injection, XSS, etc.)
- Understand CWE (Common Weakness Enumeration) categories
- Propose secure alternatives to dangerous functions
- Maintain code functionality while fixing security issues
- Explain vulnerabilities and fixes for developer education

## Tools Available

- **Static Analysis**: Code scanning tools (Bandit, custom analyzers)
- **Pattern Matching**: Vulnerability signature detection
- **Test Execution**: Verification that fixes don't break functionality
- **Code Formatting**: Ensuring proper syntax and style

## Structure
- `src/sv_env_code_vulnerability/`: Package sources
- `tests/`: Test suite

## Local install (editable)
From repo root after creating a uv venv:
```bash
uv pip install -e environments/sv-env-code-vulnerability
```
